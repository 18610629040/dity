<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.dity.dao.DityDaoMapper">
	
	<select id="qryUserList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT  ID,
				USER_NO,
				PASS,
				USER_NAME,
				MOBILE_NO,
				USER_ADD,
				USER_AGE,
				USER_BIRTH,
				USER_TYPE,
				CASE USER_TYPE
					WHEN 1 THEN
						'管理员'
					WHEN 2 THEN
						'普通用户'
					ELSE
						USER_TYPE
				END USER_TYPE_NAME,
				STATUS,
				BANK_NO,
				BANK_NAME,
				REAL_NAME,
				WX_NO,
				ZFB_NO,
				WX_FILE_URL,
				ZFB_FILE_URL,
				DATE_FORMAT(CRITE_TIME,'%Y-%m-%d %H:%i:%s') CRITE_TIME,
				CRITE_USER
		FROM T_DITY_USER T where 1=1
		<if test="ID != null and ID !=''">
			and ID = #{ID}
		</if>
		<if test="USER_NAME != null and USER_NAME !=''">
			and USER_NAME like concat('%',#{USER_NAME},'%')
		</if>
		<if test="USER_NO != null and USER_NO !=''">
			and USER_NO like concat('%',#{USER_NO},'%')
		</if>
		<if test="USER_TYPE != null and USER_TYPE !=''">
			and USER_TYPE = #{USER_TYPE}
		</if>
		order by USER_TYPE
	</select>
	
	<select id="getUserByNo" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT  ID,
				USER_NO,
				PASS,
				USER_NAME,
				MOBILE_NO,
				USER_AGE,
				USER_BIRTH,
				USER_TYPE,
				CASE USER_TYPE
					WHEN 1 THEN
						'管理员'
					WHEN 2 THEN
						'普通用户'
					ELSE
						USER_TYPE
				END USER_TYPE_NAME,
				STATUS,
				BANK_NO,
				BANK_NAME,
				REAL_NAME,
				WX_NO,
				ZFB_NO,
				WX_FILE_URL,
				ZFB_FILE_URL,
				DATE_FORMAT(CRITE_TIME,'%Y-%m-%d %H:%i:%s') CRITE_TIME,
				CRITE_USER
			FROM T_DITY_USER T where 1=1
		<if test="ID != null and ID !=''">
			and ID != #{ID}
		</if>
		<if test="USER_NO != null and USER_NO !=''">
			and USER_NO = #{USER_NO}
		</if>
	</select>
	
	<insert id="addUser" parameterType="java.util.HashMap">
		INSERT INTO T_DITY_USER (
				ID,
				USER_NO,
				PASS,
				USER_NAME,
				MOBILE_NO,
				USER_AGE,
				USER_BIRTH,
				USER_TYPE,
				STATUS,
				BANK_NO,
				BANK_NAME,
				REAL_NAME,
				WX_NO,
				ZFB_NO,
				WX_FILE_URL,
				ZFB_FILE_URL,
				CRITE_TIME,
				CRITE_USER 
			) VALUES (
				#{ID},
				#{USER_NO},
				#{PASS},
				#{USER_NAME},
				#{MOBILE_NO},
				#{USER_AGE},
				#{USER_BIRTH},
				#{USER_TYPE},
				#{STATUS},
				#{BANK_NO},
				#{BANK_NAME},
				#{REAL_NAME},
				#{WX_NO},
				#{ZFB_NO},
				#{WX_FILE_URL},
				#{ZFB_FILE_URL},
				SYSDATE(),
				#{CRITE_USER}
			)
	</insert>
	
	<update id="editUser" parameterType="java.util.HashMap">
		UPDATE T_DITY_USER T SET 
				T.ID = #{ID}
				<if test="USER_NO != null and USER_NO !=''">
				, T.USER_NO = #{USER_NO}
				</if>
				<if test="PASS != null and PASS !=''">
				, T.PASS = #{PASS}
				</if>
				<if test="USER_NAME != null and USER_NAME !=''">
				, T.USER_NAME = #{USER_NAME}
				</if>
				<if test="MOBILE_NO != null and MOBILE_NO !=''">
				, T.MOBILE_NO = #{MOBILE_NO}
				</if>
				<if test="USER_ADD != null and USER_ADD !=''">
				, T.USER_ADD = #{USER_ADD}
				</if>
				<if test="USER_AGE != null and USER_AGE !=''">
				, T.USER_AGE = #{USER_AGE}
				</if>
				<if test="USER_BIRTH != null and USER_BIRTH !=''">
				, T.USER_BIRTH = #{USER_BIRTH}
				</if>
				<if test="USER_TYPE != null and USER_TYPE !=''">
				, T.USER_TYPE = #{USER_TYPE}
				</if>
				<if test="BANK_NO != null and BANK_NO !=''">
				, T.BANK_NO = #{BANK_NO}
				</if>
				<if test="BANK_NAME != null and BANK_NAME !=''">
				, T.BANK_NAME = #{BANK_NAME}
				</if>
				<if test="REAL_NAME != null and REAL_NAME !=''">
				, T.REAL_NAME = #{REAL_NAME}
				</if>
				<if test="WX_NO != null and WX_NO !=''">
				, T.WX_NO = #{WX_NO}
				</if>
				<if test="ZFB_NO != null and ZFB_NO !=''">
				, T.ZFB_NO = #{ZFB_NO}
				</if>
				<if test="WX_FILE_URL != null and WX_FILE_URL !=''">
				, T.WX_FILE_URL = #{WX_FILE_URL}
				</if>
				<if test="ZFB_FILE_URL != null and ZFB_FILE_URL !=''">
				, T.ZFB_FILE_URL = #{ZFB_FILE_URL}
				</if>
				<if test="TX_FILE_URL != null and TX_FILE_URL !=''">
				, T.TX_FILE_URL = #{TX_FILE_URL}
				</if>
				<if test="STATUS != null and STATUS !=''">
				, T.STATUS = #{STATUS}
				</if>
			WHERE T.ID = #{ID}
	</update>
	
	<delete id="delUser" parameterType="java.util.HashMap">
		DELETE FROM T_DITY_USER WHERE ID = #{ID}
	</delete>
		
	<insert id="addRottn" parameterType="java.util.HashMap">
		INSERT INTO t_dity_rottn_chrt (
			ID,
			IMAGE_ORDER,
			IMAGE_NAME,
			FILE_URL
		)select #{ID},IFNULL((SELECT max(IMAGE_ORDER) FROM t_dity_rottn_chrt ), 0 ) +1,
					#{IMAGE_NAME},#{FILE_URL} from dual
	</insert>
	
	<select id="qryRottnChrt" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT * FROM T_DITY_ROTTN_CHRT order by IMAGE_ORDER
	</select>
	
	<select id="qryRottnChrtById" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT * FROM T_DITY_ROTTN_CHRT where ID = #{ID}
	</select>
	
	<delete id="delItton" parameterType="java.util.HashMap">
		DELETE FROM T_DITY_ROTTN_CHRT WHERE ID = #{ID}
	</delete>
	
	<update id="editIttonOrder" parameterType="java.util.HashMap">
		UPDATE T_DITY_ROTTN_CHRT SET 
				IMAGE_ORDER = #{IMAGE_ORDER}
			WHERE ID = #{ID}
	</update>
	
	
	<select id="qryGoodsMsList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			*,
			CASE STATUS
				WHEN 0 THEN
					'下架'
				WHEN 1 THEN
					'正常'
				ELSE
					STATUS
			END STATUS_NAME,
		 	DATE_FORMAT(CRITE_TIME,'%Y-%m-%d %H:%i:%s') CRITE_TIME
		FROM T_DITY_GOODS_MS T
			WHERE 1 = 1
		<if test="ID != null and ID !=''">
			and ID = #{ID}
		</if>
		<if test="NAME != null and NAME !=''">
			and NAME like concat('%',#{NAME},'%')
		</if>
	</select>
	
	<insert id="addGoodsMs" parameterType="java.util.HashMap">
		INSERT INTO T_DITY_GOODS_MS (
				ID,
				NAME,
				PRICE,
				INTRDCT,
				OWN_ACNT,
				FILE_URL,
				STATUS,
				BUY_TIME,
				WT_TIME,
				BUY_DATE,
				WT_DATE,
				CRITE_TIME,
				CRITE_USER
			) VALUES (
				#{ID},
				#{NAME},
				#{PRICE},
				#{INTRDCT},
				null,
				#{FILE_URL},
				1,
				#{BUY_TIME},
				#{WT_TIME},
				#{BUY_DATE},
				#{WT_DATE},
				SYSDATE(),
				#{CRITE_USER}
			)
	</insert>
	
	<update id="editGoodsMs" parameterType="java.util.HashMap">
		UPDATE T_DITY_GOODS_MS T SET 
				T.NAME = #{NAME}, 
				T.PRICE = #{PRICE},
				T.INTRDCT = #{INTRDCT}, 
				T.BUY_TIME = #{BUY_TIME}, 
				T.WT_TIME = #{WT_TIME},
				T.BUY_DATE = #{BUY_DATE}, 
				T.WT_DATE = #{WT_DATE}, 
				T.FILE_URL = #{FILE_URL}
			WHERE T.ID = #{ID}
	</update>
	
	<delete id="delGoodsMs" parameterType="java.util.HashMap">
		DELETE FROM T_DITY_GOODS_MS WHERE ID = #{ID}
	</delete>
	
	<update id="setGoodsMsStatus" parameterType="java.util.HashMap">
		UPDATE T_DITY_GOODS_MS T SET 
				T.STATUS = #{STATUS}
			WHERE T.ID = #{ID}
	</update>
	
	
	<select id="qryGoodsList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT *,
			CASE STATUS
				WHEN 0 THEN
					'下架'
				WHEN 1 THEN
					'正常'
				ELSE
					STATUS
			END STATUS_NAME,
		 	DATE_FORMAT(CRITE_TIME,'%Y-%m-%d %H:%i:%s') CRITE_TIME
		FROM T_DITY_GOODS T
			WHERE 1 = 1
		<if test="ID != null and ID !=''">
			and ID = #{ID}
		</if>
		<if test="NAME != null and NAME !=''">
			and NAME like concat('%',#{NAME},'%')
		</if>
		<if test="GOODS_TYPE != null and GOODS_TYPE !=''">
			and GOODS_TYPE = #{GOODS_TYPE}
		</if>
	</select>
	
	<insert id="addGoods" parameterType="java.util.HashMap">
		INSERT INTO T_DITY_GOODS (
				ID,
				NAME,
				PRICE,
				INTRDCT,
				GOODS_TYPE,
				OWN_ACNT,
				STATUS,
				FILE_URL,
				CRITE_TIME,
				CRITE_USER
			) VALUES (
				#{ID},
				#{NAME},
				#{PRICE},
				#{INTRDCT},
				#{GOODS_TYPE},
				null,
				1,
				#{FILE_URL},
				SYSDATE(),
				#{CRITE_USER}
			)
	</insert>
	
	<update id="editGoods" parameterType="java.util.HashMap">
		UPDATE T_DITY_GOODS T SET 
				T.NAME = #{NAME}, 
				T.PRICE = #{PRICE},
				T.INTRDCT = #{INTRDCT}, 
				T.GOODS_TYPE = #{GOODS_TYPE},
				T.FILE_URL = #{FILE_URL}
			WHERE T.ID = #{ID}
	</update>
	
	<delete id="delGoods" parameterType="java.util.HashMap">
		DELETE FROM T_DITY_GOODS WHERE ID = #{ID}
	</delete>
	
	<update id="setGoodsStatus" parameterType="java.util.HashMap">
		UPDATE T_DITY_GOODS T SET 
				T.STATUS = #{STATUS}
			WHERE T.ID = #{ID}
	</update>
	
	
	<select id="qryUserDz" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT * FROM T_DITY_USERDZ 
		<if test="ID != null and ID !=''">
			where ID = #{ID}
		</if>
		<if test="USER_NO != null and USER_NO !=''">
			where USER_NO = #{USER_NO}
		</if>
	</select>
	
	<insert id="addUserDz" parameterType="java.util.HashMap">
		INSERT INTO T_DITY_USERDZ (
				ID,
				USER_NO,
				SH_NAME,
				PHTONENO,
				DIQU,
				XXDZ,
				ISMOREN,
				YOUBIAN
			) VALUES (
				#{ID},
				#{USER_NO},
				#{SH_NAME},
				#{PHTONENO},
				#{DIQU},
				#{XXDZ},
				#{ISMOREN},
				#{YOUBIAN}
			)
	</insert>
	
	<update id="editUserDz" parameterType="java.util.HashMap">
		UPDATE T_DITY_USERDZ T SET 
				T.SH_NAME = #{SH_NAME},
				T.PHTONENO = #{PHTONENO},
				T.DIQU = #{DIQU},
				T.XXDZ = #{XXDZ},
				T.ISMOREN = #{ISMOREN},
				T.YOUBIAN = #{YOUBIAN}
			WHERE T.ID = #{ID}
	</update>
	
	<update id="setUserDzMr" parameterType="java.util.HashMap">
		UPDATE T_DITY_USERDZ T SET 
				T.ISMOREN = 1
			WHERE T.ID = #{ID}
	</update>
	
	<update id="setUserDzMr2" parameterType="java.util.HashMap">
		UPDATE T_DITY_USERDZ T SET 
				T.ISMOREN = 0
			WHERE T.USER_NO = #{USER_NO}
	</update>
	
	<delete id="delUserDz" parameterType="java.util.HashMap">
		DELETE FROM T_DITY_USERDZ WHERE ID = #{ID}
	</delete>
	
	<insert id="addOrder" parameterType="java.util.HashMap">
		INSERT INTO t_dity_order (
				ID,
				ORDER_NO,
				ORDER_PD,
				ORDER_PD_NAME,
				ORDER_PRICE,
				ORDER_CVAL,
				ORDER_CFEE,
				ORDER_INCOM,
				ORDER_EXPRESS,
				ORDER_USER_NO,
				STATUS,
				OPTION_TIME,
				OPTION_USER
			) VALUES (
				#{ID},
				#{ORDER_NO},
				#{ORDER_PD},
				#{ORDER_PD_NAME},
				#{ORDER_PRICE},
				#{ORDER_CVAL},
				#{ORDER_CFEE},
				#{ORDER_INCOM},
				#{ORDER_EXPRESS},
				#{ORDER_USER_NO},
				#{STATUS},
				SYSDATE(),
				#{OPTION_USER}
			)
	</insert>
	
	<select id="qryOrder" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT ID,
			ORDER_NO,
			ORDER_PD,
			ORDER_PD_NAME,
			ORDER_PRICE,
			ORDER_CVAL,
			ORDER_CFEE,
			ORDER_INCOM,
			ORDER_EXPRESS,
			ORDER_USER_NO,
			STATUS,
			DATE_FORMAT(OPTION_TIME,'%Y-%m-%d %H:%i:%s') OPTION_TIME
			OPTION_USER 
		FROM t_dity_order where 1=1
		<if test="ID != null and ID !=''">
			and ID = #{ID}
		</if>
		<if test="ORDER_USER_NO != null and ORDER_USER_NO !=''">
			and ORDER_USER_NO = #{ORDER_USER_NO}
		</if>
		<if test="STATUS != null and STATUS !=''">
			and STATUS = #{STATUS}
		</if>
	</select>
	
	<update id="setOrder" parameterType="java.util.HashMap">
		UPDATE t_dity_order T SET 
				T.STATUS = #{STATUS}
			WHERE T.ID = #{ID}
	</update>
	
	<delete id="delOrder" parameterType="java.util.HashMap">
		DELETE FROM t_dity_order WHERE ID = #{ID}
	</delete>
	
</mapper>